{
    "version": "https://jsonfeed.org/version/1",
    "title": "Yihong Liu's Blog • All posts by \"research\" category",
    "description": "Yihong Liu is a PhD student in the Management Science, Information Systems Concentration at the Naveen Jindal School of Management, UT Dallas.",
    "home_page_url": "https://blog.yihong-liu.com",
    "items": [
        {
            "id": "https://blog.yihong-liu.com/2022/03/12/MIS-Conference-Calendar/",
            "url": "https://blog.yihong-liu.com/2022/03/12/MIS-Conference-Calendar/",
            "title": "MIS Conference Calendar",
            "date_published": "2022-03-12T17:24:31.000Z",
            "content_html": "<p>Stay on Top of MIS Conference Deadlines with Ease!</p>\n<p>Discover the Convenience of my Reliable MIS Conference Calendar!</p>\n<span id=\"more\"></span>\n\n<p>Photo by <a href=\"https://unsplash.com/@charlesdeluvio?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText\">charlesdeluvio</a> on <a href=\"https://unsplash.com/s/photos/calendar?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText\">Unsplash</a>\n  </p>\n",
            "tags": [
                "Research",
                "MIS",
                "IS",
                "Management Information Systems",
                "Information Systems",
                "Conference",
                "Calendar"
            ]
        },
        {
            "id": "https://blog.yihong-liu.com/2021/04/03/Understanding-Bilibili-s-Business-Model/",
            "url": "https://blog.yihong-liu.com/2021/04/03/Understanding-Bilibili-s-Business-Model/",
            "title": "Understanding Bilibili's Business Model",
            "date_published": "2021-04-03T05:24:23.000Z",
            "content_html": "<p>Bilibili is an iconic brand and a leading video community for young generations in China. This post includes my understadning and interpretation of Bilibili’s business model.</p>\n<span id=\"more\"></span>\n\n<h2 id=\"Introduction\"><a href=\"#Introduction\" class=\"headerlink\" title=\"Introduction\"></a>Introduction</h2><hr>\n<p>Recent years have certified the rapid emergence and growth of online video communities, e.g. <a href=\"https://youtube.com/\">YouTube.com</a>, <a href=\"https://www.facebook.com/watch\">Facebook Watch</a>, <a href=\"https://www.tiktok.com/\">TikTok.com</a>, and <a href=\"https://bilibili.com/\">bilibili.com</a>, whose services mainly cover video publishing, experiencing, searching, commenting, tipping, marketing, and live-streaming through their Web-based platforms which are accessible via computers and mobile phones.<br>According to the <a href=\"https://www.limelight.com/resources/market-research/state-of-online-video-2020/\">Limelight’s market research</a> towards online video in 2020, viewers spend nearly eight hours per week on average in watching various types of video content, and online video consumption has been enlarged across all age groups.</p>\n<p>This post focuses on <a href=\"https://bilibili.com/\">bilibili.com</a>, an iconic and leading online video community for young generations in China. From her <a href=\"https://ir.bilibili.com/static-files/98bfad59-0a57-467c-a3f4-e250c3bada4b\">2020 annual report</a>, on average she attracted 202 million monthly active users and 1.2 billion daily video views in the fourth quarter, 5.1 billion monthly interactions, and 5.6 million monthly video submissions by 1.8 million monthly active content creators. This enormous and flourishing pool of users and content creators ensures revenue generation from affiliated mobile games, membership subscription, tipping, advertising, and online shopping.</p>\n<h2 id=\"Bilibili-com-An-Online-Video-Community\"><a href=\"#Bilibili-com-An-Online-Video-Community\" class=\"headerlink\" title=\"Bilibili.com: An Online Video Community\"></a><a href=\"https://bilibili.com/\">Bilibili.com</a>: An Online Video Community</h2><hr>\n<p>In this section, we dig into <a href=\"https://bilibili.com/\">bilibili.com</a>, an iconic online video community for young Chinese generations, by approaching her from two aspects: an online video platform and a video-centered community.<br>The online video platform is where content creators publish their videos and users consume videos of their interest. And the social interactions among content creators and users consist of a video-centered community. Overall, an online video community is an online ecosystem among content creators and users around videos.<br>Then we graphically illustrate <a href=\"https://bilibili.com/\">bilibili.com</a>‘s business model to demonstrate how <a href=\"https://bilibili.com/\">bilibili.com</a> practices her commercialization efforts. Note that <a href=\"https://bilibili.com/\">bilibili.com</a> provides mobile App and PC Website entrances, and we mainly exploit the mobile App in this post for clear demonstration and simplicity. </p>\n<h3 id=\"An-Online-Video-Platform\"><a href=\"#An-Online-Video-Platform\" class=\"headerlink\" title=\"An Online Video Platform\"></a>An Online Video Platform</h3><hr>\n<div class=\"justified-gallery\">\n\n<p><img src=\"/asplatform.jpg\" alt=\"Platform&#39;s Stakeholders: Users and Content Creators\"></p>\n</div>\n\n<p>We walk through the details of how <a href=\"https://bilibili.com/\">bilibili.com</a> operates as an online video platform in this section. As illustrated in the figure above, two main stakeholders get involved on this video platform: users and content creators. Content creators can upload their videos or start live-streaming, namely professional user generated video (PUGV), which are consumed by users. <a href=\"https://bilibili.com/\">bilibili.com</a> also offers licensed contents, called occupationally generated videos (OGV), to users from third-party production companies, ranging from TV shows, movies, cartoon to anime.<br>Users can be categorized into three types. Viewers without registration can only watch PUGV.<br>Free registered membership gives users access to watch and comment in PUGV, follow and tip content creators, upload videos, and start live-streaming.<br>In addition to the free membership, premium membership comes with fees, allowing users to enjoy advanced PUGV (e.g., higher resolution, high dynamic range, Dolby audio), OGV, fancy comment emoji, and deals in mobile games and online shopping.<br>Note that content creators at least have free membership.</p>\n<div class=\"justified-gallery\">\n\n<p><img src=\"/homepage.jpg\" alt=\"App Home Page\"></p>\n</div>\n\n<p>The above figure depicts the home page of <a href=\"https://bilibili.com/\">bilibili.com</a>‘s mobile App. On the top, users can click the avatar and go to their profile page, search content of interests with keywords in the search box, and check private messages within the inbox.<br>At the bottom, five entrances appear.<br>The category page allows users to view content by predefined channels, e.g., anime, music, dance, video game, education, technology, daily life, food, animal, fashion, movies, and TV shows.<br>The feed page includes all content from users’ followed content creators and advertising.<br>The shopping page is a typical e-commerce site, supplying products related to anime, cartoons, and video games.<br>The profile page integrates users’ profile information, followers and followings, browsing history, favorites of content, uploaded content management, premium membership subscription, and App setting.<br>The rest of the home page is a video waterfall, i.e., a list of videos, which consists of banners, ordinary videos, sponsored videos, and advertising.</p>\n<div class=\"justified-gallery\">\n\n<p><img src=\"/videopage-nocol.jpg\" alt=\"Description Section of A Video Page\"></p>\n</div>\n\n<p>Clicking on a video will be directed to a typical video page, demonstrated in the figure above. In the video description section, users can follow the focal content creator (e.g. CC1) and go to CC1’s personal page by clicking her avatar. CC1’s personal page has CC1’s basic information including self-introduction and numbers of followers and followings, and a list of all her uploaded videos. Users can also send feedback in the video page, e.g., like or dislike, tipping the focal content creator, adding the focal video into her favorites and sharing this video. The comment section functions as a discussion board, in which registered users can interact with each other by comments and replies.</p>\n<h3 id=\"A-Video-centered-Community\"><a href=\"#A-Video-centered-Community\" class=\"headerlink\" title=\"A Video-centered Community\"></a>A Video-centered Community</h3><hr>\n<div class=\"justified-gallery\">\n\n<p><img src=\"/feedpage.jpg\" alt=\"App Feed Page\"></p>\n</div>\n\n<p><a href=\"https://bilibili.com/\">bilibili.com</a> establishes its online community upon the social network between content creators and their followers, and discussion boards among users and content creators around videos.<br>Generally, users can click the follow button on a video display page or on the personal page of a content creator, as strong evidence of interest, to become a follower. By doing so, those followers will be notified on their mobile phones and feed page every time the followed content creator commits a new activity, e.g., tweets, live-streaming, or publishing a new video. In the feed page shown above, a user can browse all activities from her followed content creators ordered by posted time, and filter activities by tags. Moreover, a user can also post a tweet-like message, usually text with images, by clicking on the post button in the top-right corner. Note that a user can follow multiple content creators.</p>\n<div class=\"justified-gallery\">\n\n<p><img src=\"/videopage-cmt.jpg\" alt=\"Discussion Section of A Video Page\"></p>\n</div>\n\n<p>The figure above uncovers the discussion board (“comments” section) of a video display page.<br>For every uploaded video, all registered users, including content creators, can interact with others in the comment section by leaving comments, replying to others’ comments, providing feedback (like or dislike) on comments, or sharing comments.<br>Comments are in a popularity-ranked sequence by default, or can be ranked by posted time. Taking the top-ranked comment, posted by User 1, in the figure above for example, it is the most popular one since it receives the highest number of likes in this video’s comment section. CC and User 3 replied to User 1 directly, and User 2 responded to the CC’s reply. Each interaction (comment or reply) can be modeled as a directed edge from the sender to the receiver, in a network derived from the discussion board.</p>\n<p>Furthermore, <a href=\"https://bilibili.com/\">bilibili.com</a> provides one-to-one private messages among registered users.</p>\n<h3 id=\"Bilibili-com‘s-Business-Model\"><a href=\"#Bilibili-com‘s-Business-Model\" class=\"headerlink\" title=\"Bilibili.com‘s Business Model\"></a><a href=\"https://bilibili.com/\">Bilibili.com</a>‘s Business Model</h3><hr>\n<div class=\"justified-gallery\">\n\n<p><img src=\"/bus-model.jpg\" alt=\"bilibili.com&#39;s Business Model\"></p>\n</div>\n\n<p><a href=\"https://bilibili.com/\">bilibili.com</a> operates this online video community to achieve her commercialization goal, explained in the previous figure.<br>Unregistered viewers come to <a href=\"https://bilibili.com/\">bilibili.com</a> due to word-of-mouth (WOM) of funny content or searching for content of their interests. A multiple-choice quiz of 100 questions is mandatory to become a registered member without charge, within 60 minutes on community rules and knowledge about anime, cartoons, and video games. This membership exam hopes to ensure community etiquette, loyalty, and stickiness. Note that content creators at least have the free membership.<br>Registered users and content creators are retained by the online video community, i.e., interactions among content creators and users in social networks, and discussion boards around OGV and content creators’ uploaded PUGV.<br>Additionally, <a href=\"https://bilibili.com/\">bilibili.com</a> provides auxiliary services for content creators, including influence and exposure promotion, monetization incentives, tutorials and seminars in video editing and recording, and data analysis for uploaded videos. </p>\n<p><a href=\"https://bilibili.com/\">bilibili.com</a>‘s <a href=\"https://ir.bilibili.com/static-files/98bfad59-0a57-467c-a3f4-e250c3bada4b\">2020 annual report</a> says that the 3rd-month, 6th-month, 9th-month and 12th-month retention rate remained above 80%, for registered users who visited <a href=\"https://bilibili.com/\">bilibili.com</a> in each month since 2018. The “retention rate” of users who visit <a href=\"https://bilibili.com/\">bilibili.com</a> via mobile App or PC website in a given period, are to the percentage of these users who make at least one repeat visit after a certain duration; e.g., the “3rd-month retention rate” for users in a given month is the retention rate in the third month after the applicable month. <a href=\"https://bilibili.com/\">bilibili.com</a> then extracted revenue from retained users with four major sources, including mobile games affiliation, value-added service (premium membership subscription and tipping), advertising, and e-commerce (online shopping).</p>\n<p>Apparently, the success of <a href=\"https://bilibili.com/\">bilibili.com</a>‘s commercialization depends heavily on the community vibrancy and participation of retained users and content creators.</p>\n<h2 id=\"Video-Collaboration\"><a href=\"#Video-Collaboration\" class=\"headerlink\" title=\"Video Collaboration\"></a>Video Collaboration</h2><hr>\n<p>With the goal of boosting her online video community vibrancy, a feature called video collaboration was newly introduced on <a href=\"https://bilibili.com/\">bilibili.com</a>.</p>\n<div class=\"justified-gallery\">\n\n<p><img src=\"/videopage-col.jpg\" alt=\"A Collaborated Video Page\"></p>\n</div>\n\n<p>In addition to a video published by a single content creator, <a href=\"https://bilibili.com/\">bilibili.com</a> allows a team of content creators to collaborate on one video, whose display page shows all team members with usernames, avatars, roles labeled, following buttons, and links to their personal page.<br>The figure above shows the video display page of a collaborated video. For every team member, her personal page will exhibit this video, and all her followers will be notified of it once published via mobile phone notification and feed page. If a user follows multiple content creators in one team, this user will only receive one notification when this team newly publishes a video.</p>\n<p>Stakeholders in this online video community can be benefitted with good collaboration on video production.<br>For participated content creators, a wider set of video skills can bring impossible content to life, more creators’ labor can lead to better content quality, and more followers’ being notified can increase video exposure and the chance of receiving followers.<br>For the online video community, more followers’ being notified can contribute to community vibrancy by increasing the opportunity of interactions among content creators and users, and content creators in teams could establish belongingness and loyalty to the community by working together.<br>And for users, more of them can be entertained and retained because of high content quality and vivacious community environment.</p>\n<p>Note that before the introduction of video collaboration on <a href=\"https://bilibili.com/\">bilibili.com</a>, content creators could still collaborate offline and upload their joint work by one content creator as the way of individual video production and display. For instance, the collaborated video in the figure above can be uploaded by only content creator CC1 as the way of individual video without video collaboration. However, the additional benefits, e.g., all team members, i.e., CC2 and CC3, listed on the video display page and every follower notified, are not available without the video collaboration characteristic.<br>To boot, without video collaboration, CC1, CC2, and CC3 can separately publish this video, resulting in its exhibition on their personal page as individual work, and every follower will be notified. However, by doing so, community vibrancy metrics are also separately calculated for three videos of the same content but different uploaders, which decreases total video performance, the chance of video exposure, and the opportunity of attracting new followers, compared to the collaborated version. And for users who only follow CC1 but not CC2 or CC3, video collaboration can inform them of CC2 and CC3, and these users may become new followers of CC2 and CC3.<br>Moreover, content creators in this team would establish additional belongingness and loyalty to the community by working together.</p>\n<p><a style=\"background-color:black;color:white;text-decoration:none;padding:4px 6px;font-family:-apple-system, BlinkMacSystemFont, &quot;San Francisco&quot;, &quot;Helvetica Neue&quot;, Helvetica, Ubuntu, Roboto, Noto, &quot;Segoe UI&quot;, Arial, sans-serif;font-size:12px;font-weight:bold;line-height:1.2;display:inline-block;border-radius:3px\" href=\"https://unsplash.com/@victorhwn725?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText\" target=\"_blank\" rel=\"noopener noreferrer\" title=\"Download free do whatever you want high-resolution photos from Victor He\"><span style=\"display:inline-block;padding:2px 3px\"><svg xmlns=\"http://www.w3.org/2000/svg\" style=\"height:12px;width:auto;position:relative;vertical-align:middle;top:-2px;fill:white\" viewBox=\"0 0 32 32\"><title>unsplash-logo</title><path d=\"M10 9V0h12v9H10zm12 5h10v18H0V14h10v9h12v-9z\"></path></svg></span><span style=\"display:inline-block;padding:2px 3px\">thumbnail by Victor He</span></a></p>\n",
            "tags": [
                "Ph.D.",
                "Research",
                "Online Video Community",
                "Bilibili",
                "Business Model",
                "Video Collaboration",
                "哔哩哔哩",
                "B站",
                "商业模型",
                "联合投稿"
            ]
        },
        {
            "id": "https://blog.yihong-liu.com/2020/06/26/Understanding-BPR-COFISET-and-BPRH/",
            "url": "https://blog.yihong-liu.com/2020/06/26/Understanding-BPR-COFISET-and-BPRH/",
            "title": "Understanding BPR, COFISET and BPRH",
            "date_published": "2020-06-27T02:53:11.000Z",
            "content_html": "<p>BPR, COFISET, and BPRH all focus on collaborative filtering with matrix factorization and implicit feedbacks. This task is different from 5-star rating estimation in a sense that only some users’ action behaviors (e.g. purchase, view, like, dislike) are available. </p>\n<p>This post includes my understanding of these three models.</p>\n<span id=\"more\"></span>\n\n<h1 id=\"TODO\"><a href=\"#TODO\" class=\"headerlink\" title=\"TODO\"></a>TODO</h1><ul>\n<li><input disabled=\"\" type=\"checkbox\"> BPR</li>\n<li><input checked=\"\" disabled=\"\" type=\"checkbox\"> Backgrounds for COFISET</li>\n<li><input checked=\"\" disabled=\"\" type=\"checkbox\"> Backgrounds for BPRH</li>\n<li><input checked=\"\" disabled=\"\" type=\"checkbox\"> SGD for CIFISET and BPRH</li>\n<li><input checked=\"\" disabled=\"\" type=\"checkbox\"> Implementation codes for BPRH in Jupyter Notebook on a small and simple example</li>\n<li><input checked=\"\" disabled=\"\" type=\"checkbox\"> Full Implementation codes for BPRH</li>\n</ul>\n<h1 id=\"BPR\"><a href=\"#BPR\" class=\"headerlink\" title=\"BPR\"></a>BPR</h1><hr>\n<div class=\"notification is-success is-size-6\">\n <p style=\"text-align: center;\"><b> UNDER CONSTRUCTION </b></p>\n</div>\n\n<h2 id=\"Implementation\"><a href=\"#Implementation\" class=\"headerlink\" title=\"Implementation\"></a>Implementation</h2><p>You may find several verions of BPR implementations below.</p>\n<ul>\n<li><a href=\"https://github.com/jokingcoco/BPR_Bayesian-Personalized-Ranking_MPR_Multiple-Pairwise-Ranking\">https://github.com/jokingcoco/BPR_Bayesian-Personalized-Ranking_MPR_Multiple-Pairwise-Ranking</a></li>\n<li><a href=\"https://github.com/valerystrizh/bpr\">https://github.com/valerystrizh/bpr</a></li>\n<li><a href=\"https://github.com/lyst/lightfm\">https://github.com/lyst/lightfm</a></li>\n<li><a href=\"https://github.com/sh0416/bpr\">https://github.com/sh0416/bpr</a></li>\n<li><a href=\"https://github.com/guoguibing/librec/search?q=BPR&unscoped_q=BPR\">https://github.com/guoguibing/librec/search?q=BPR&unscoped_q&#x3D;BPR</a></li>\n</ul>\n<h1 id=\"COFISET\"><a href=\"#COFISET\" class=\"headerlink\" title=\"COFISET\"></a>COFISET</h1><hr>\n<h2 id=\"Item-sets-and-Pairwise-Preferences\"><a href=\"#Item-sets-and-Pairwise-Preferences\" class=\"headerlink\" title=\"Item-sets and Pairwise Preferences\"></a>Item-sets and Pairwise Preferences</h2>\n\nAn item-set is a set of items. A user $u$'s preference over an item-set is a function of $u$'s preferences on items in this item-set. For example, $u$'s preference on item-set $\\mathcal{P}$ can be $\\hat{r}_{u \\mathcal{P}} = |\\mathcal{P}|^{-1} \\sum_{i \\in \\mathcal{P}} \\hat{r}_{ui}$. $\\hat{r}_{ui}$ is $u$'s estimated preference on item $i$.\n\nA user $u$'s pairwise preference  over two item-sets $\\mathcal{P}, \\mathcal{A}$ is defined as $\\hat{r}_{u \\mathcal{P} \\mathcal{A}} = \\hat{r}_{u \\mathcal{P}} - \\hat{r}_{u \\mathcal{A}}$. And in COFISET, the assumption of pairwise preference is $\\hat{r}_{u \\mathcal{P} \\mathcal{A}} = \\hat{r}_{u \\mathcal{P}} - \\hat{r}_{u \\mathcal{A}} > 0, \\mathcal{P} \\subseteq \\mathcal{I}^{tr}_{u}, \\mathcal{A} \\subseteq \\mathcal{I}^{tr} \\setminus \\mathcal{I}^{tr}_{u}$. $\\mathcal{P} \\subseteq \\mathcal{I}^{tr}_{u}$ is a set of items of observed feedback from user $u$ and $\\mathcal{A} \\subseteq \\mathcal{I}^{tr} \\setminus \\mathcal{I}^{tr}_{u}$ is a set of items without observed feedback from user $u$.\n\n\n\n<h2 id=\"Objective-Function-and-Optimization\"><a href=\"#Objective-Function-and-Optimization\" class=\"headerlink\" title=\"Objective Function and Optimization\"></a>Objective Function and Optimization</h2><p>COFISET’s relaxed optimization for all users is </p>\n\n\n$$ \\min_{\\Theta} \\sum_{u \\in \\mathcal{U}^{tr}} \\sum_{\\mathcal{P} \\subseteq \\mathcal{I}_{u}^{tr}} \\sum_{\\mathcal{A} \\subseteq \\mathcal{I} \\setminus \\mathcal{I}_{u}^{tr}} \\left[ \\mathcal{L}(u, \\mathcal{P}, \\mathcal{A}) + \\mathcal{R}(u, \\mathcal{P}, \\mathcal{A}) \\right]  $$\n, where $\\Theta = \\{ U_{u} \\in \\mathbb{R}^{ d \\times 1}, V_{i} \\in \\mathbb{R}^{d \\times 1}, b_i \\in \\mathbb{R}, u \\in \\mathcal{U}^{tr}, i \\in \\mathcal{I}^{tr} \\}$ is the set of model parameter, the loss term $\\mathcal{L}(u, \\mathcal{P}, \\mathcal{A}) = - \\ln{\\sigma(\\hat{r}_{u\\mathcal{P}\\mathcal{A}})}$, $\\sigma(z) = 1/(1+\\exp{(-z)})$, the pairwise preferences of user $u$ across 2 item-sets $\\mathcal{P}$ and $\\mathcal{A}$ is $\\hat{r}_{u\\mathcal{P}\\mathcal{A}} = \\hat{r}_{u\\mathcal{P}} - \\hat{r}_{u\\mathcal{A}}$, the estimated preferences of user $u$ on item-sets $\\mathcal{P}$ and $\\mathcal{A}$ are $\\hat{r}_{u\\mathcal{P}} = |P|^{-1} \\sum_{i \\in \\mathcal{P}} \\hat{r}_{ui}, \\hat{r}_{u\\mathcal{A}} = |A|^{-1} \\sum_{j \\in \\mathcal{A}} \\hat{r}_{uj}$, the estimated preference of user $u$ on item $i$ is $\\hat{r}_{ui} = U_{u}^\\top V_{i} + b_i$, and the regularization term $\\mathcal{R}(u, \\mathcal{P}, \\mathcal{A}) = \\frac{\\alpha_u}{2} \\| U_u \\|^2 + \\sum_{i \\in \\mathcal{P}} [\\frac{\\alpha_V}{2} \\| V_i \\|^2 + \\frac{\\beta_V}{2} b_i^2] + \\sum_{j \\in \\mathcal{A}} [\\frac{\\alpha_V}{2} \\| V_j \\|^2 + \\frac{\\beta_V}{2} b_j^2]$.\n\n\n\n<h2 id=\"Corresponding-Gradients-in-SGD\"><a href=\"#Corresponding-Gradients-in-SGD\" class=\"headerlink\" title=\"Corresponding Gradients in SGD\"></a>Corresponding Gradients in SGD</h2><p>Stochastic gradient descent is applied in COFISET’s optimization. The corresponding gradients of model parameter $\\Theta$ w.r.t. $\\mathcal{L}(u, \\mathcal{P}, \\mathcal{A})$ and $\\mathcal{R}(u, \\mathcal{P}, \\mathcal{A})$ are</p>\n\n\n$$ \\begin{aligned} \n\\dfrac{\\partial \\mathcal{L}}{\\partial U_{u}} & = - \\dfrac{\\partial \\ln \\sigma}{\\partial \\sigma} \\dfrac{\\partial \\sigma}{\\partial \\hat{r}_{u \\mathcal{P} \\mathcal{A}} } \\dfrac{\\partial \\hat{r}_{u \\mathcal{P} \\mathcal{A}}}{\\partial U_{u}} \\\\ \n& = - \\sigma^{-1}(-\\hat{r}_{u \\mathcal{P} \\mathcal{A}}) \\sigma(-\\hat{r}_{u \\mathcal{P} \\mathcal{A}}) (1-\\sigma(-\\hat{r}_{u \\mathcal{P} \\mathcal{A}})) \\dfrac{\\partial (\\hat{r}_{u\\mathcal{P}} - \\hat{r}_{u\\mathcal{A}}) }{\\partial U_{u}}\\\\ \n& = - \\sigma(-\\hat{r}_{u \\mathcal{P} \\mathcal{A}}) (|\\mathcal{P}|^{-1} \\sum_{i \\in \\mathcal{P}} V_{i} - |\\mathcal{A}|^{-1} \\sum_{j \\in \\mathcal{A}} V_{j} ) \\\\\n& = - \\sigma(-\\hat{r}_{u \\mathcal{P} \\mathcal{A}}) (\\overline{V}_{\\mathcal{P}} - \\overline{V}_{\\mathcal{A}}), \\forall u \\in \\mathcal{U}^{tr} \\\\ \n\\dfrac{\\partial \\mathcal{R}}{\\partial U_u} & = \\alpha_{u} U_{u}, \\forall u \\in \\mathcal{U}^{tr} \\\\\n\\end{aligned} $$\n\n\n\n\n\n\n$$\\begin{aligned}\n\n\\dfrac{\\partial \\mathcal{L}}{\\partial V_{i}} & = - \\dfrac{\\partial \\ln \\sigma}{\\partial \\sigma} \\dfrac{\\partial \\sigma}{\\partial \\hat{r}_{u \\mathcal{P} \\mathcal{A}} } \\dfrac{\\partial \\hat{r}_{u \\mathcal{P} \\mathcal{A}}}{\\partial V_{i}} \\\\ \n& = - \\sigma^{-1}(-\\hat{r}_{u \\mathcal{P} \\mathcal{A}}) \\sigma(-\\hat{r}_{u \\mathcal{P} \\mathcal{A}}) (1-\\sigma(-\\hat{r}_{u \\mathcal{P} \\mathcal{A}})) \\dfrac{\\partial (\\hat{r}_{u\\mathcal{P}} - \\hat{r}_{u\\mathcal{A}}) }{\\partial V_{i}}\\\\ \n& = - \\sigma(-\\hat{r}_{u \\mathcal{P} \\mathcal{A}}) (U_{u} / |\\mathcal{P}|), \\forall i \\in \\mathcal{P} \\\\\n\\dfrac{\\partial \\mathcal{R}}{\\partial V_i} & = \\alpha_{V} V_{i}, \\forall i \\in \\mathcal{P} \\\\\n\\dfrac{\\partial \\mathcal{L}}{\\partial b_i} & = - \\dfrac{\\partial \\ln \\sigma}{\\partial \\sigma} \\dfrac{\\partial \\sigma}{\\partial \\hat{r}_{u \\mathcal{P} \\mathcal{A}} } \\dfrac{\\partial \\hat{r}_{u \\mathcal{P} \\mathcal{A}}}{\\partial b_{i}} \\\\ \n& = - \\sigma^{-1}(-\\hat{r}_{u \\mathcal{P} \\mathcal{A}}) \\sigma(-\\hat{r}_{u \\mathcal{P} \\mathcal{A}}) (1-\\sigma(-\\hat{r}_{u \\mathcal{P} \\mathcal{A}})) \\dfrac{\\partial (\\hat{r}_{u\\mathcal{P}} - \\hat{r}_{u\\mathcal{A}}) }{\\partial b_{i}}\\\\ \n& = - \\sigma(-\\hat{r}_{u \\mathcal{P} \\mathcal{A}}) / |\\mathcal{P}|, \\forall i \\in \\mathcal{P} \\\\\n\\dfrac{\\partial \\mathcal{R}}{\\partial b_i} & = \\beta_V b_{i}, \\forall i \\in \\mathcal{P} \\\\\n\\end{aligned} $$\n\n\n\n\n\n$$\\begin{aligned}\n\n\\dfrac{\\partial \\mathcal{L}}{\\partial V_j} & = - \\dfrac{\\partial \\ln \\sigma}{\\partial \\sigma} \\dfrac{\\partial \\sigma}{\\partial \\hat{r}_{u \\mathcal{P} \\mathcal{A}} } \\dfrac{\\partial \\hat{r}_{u \\mathcal{P} \\mathcal{A}}}{\\partial V_{j}} \\\\ \n& = - \\sigma^{-1}(-\\hat{r}_{u \\mathcal{P} \\mathcal{A}}) \\sigma(-\\hat{r}_{u \\mathcal{P} \\mathcal{A}}) (1-\\sigma(-\\hat{r}_{u \\mathcal{P} \\mathcal{A}})) \\dfrac{\\partial (\\hat{r}_{u\\mathcal{P}} - \\hat{r}_{u\\mathcal{A}}) }{\\partial V_{j}}\\\\ \n& = \\sigma(-\\hat{r}_{u \\mathcal{P} \\mathcal{A}}) (U_{u} / |\\mathcal{A}|), \\forall j \\in \\mathcal{A} \\\\\n\\dfrac{\\partial \\mathcal{R}}{\\partial V_j} & = \\alpha_{V} V_{j}, \\forall j \\in \\mathcal{A} \\\\\n\\dfrac{\\partial \\mathcal{L}}{\\partial b_j} & = - \\dfrac{\\partial \\ln \\sigma}{\\partial \\sigma} \\dfrac{\\partial \\sigma}{\\partial \\hat{r}_{u \\mathcal{P} \\mathcal{A}} } \\dfrac{\\partial \\hat{r}_{u \\mathcal{P} \\mathcal{A}}}{\\partial b_{j}} \\\\ \n& = - \\sigma^{-1}(-\\hat{r}_{u \\mathcal{P} \\mathcal{A}}) \\sigma(-\\hat{r}_{u \\mathcal{P} \\mathcal{A}}) (1-\\sigma(-\\hat{r}_{u \\mathcal{P} \\mathcal{A}})) \\dfrac{\\partial (\\hat{r}_{u\\mathcal{P}} - \\hat{r}_{u\\mathcal{A}}) }{\\partial b_{j}}\\\\ \n& = \\sigma(-\\hat{r}_{u \\mathcal{P} \\mathcal{A}}) / |\\mathcal{A}|, \\forall j \\in \\mathcal{A} \\\\\n\\dfrac{\\partial \\mathcal{R}}{\\partial b_j} & = \\beta_{V} b_{j}, \\forall j \\in \\mathcal{A}\n\\end{aligned} $$\n\n\n\n<h3 id=\"Updating-Rules\"><a href=\"#Updating-Rules\" class=\"headerlink\" title=\"Updating Rules\"></a>Updating Rules</h3><p>Combining the gradients w.r.t. the loss term and the regularization term, the final gradients for each variable $U_{u}, V_{i}, V_{j}, b_{i}, b_{j}, u \\in \\mathcal{U}^{tr}, i \\in \\mathcal{P}, j \\in \\mathcal{A}$ are</p>\n\n\n$$ \\begin{aligned}\n\t\\nabla U_{u} & = \\dfrac{\\partial \\mathcal{L}}{\\partial U_{u}} + \\dfrac{\\partial \\mathcal{R}}{\\partial U_{u}} \\\\ & = - \\sigma(-\\hat{r}_{u \\mathcal{P} \\mathcal{A}}) (\\overline{V}_{\\mathcal{P}} - \\overline{V}_{\\mathcal{A}}) + \\alpha_{u} U_{u} \\\\\n\t\\nabla V_{i} & = \\dfrac{\\partial \\mathcal{L}}{\\partial V_{i}} + \\dfrac{\\partial \\mathcal{R}}{\\partial V_{i}} \\\\ & = - \\sigma(-\\hat{r}_{u \\mathcal{P} \\mathcal{A}}) (U_{u} / |\\mathcal{P}|) + \\alpha_{V} V_{i} \\\\\n\t\\nabla V_{j} & = \\dfrac{\\partial \\mathcal{L}}{\\partial V_{j}} + \\dfrac{\\partial \\mathcal{R}}{\\partial V_{j}} \\\\ & = \\sigma(-\\hat{r}_{u \\mathcal{P} \\mathcal{A}}) (U_{u} / |\\mathcal{A}|) + \\alpha_{V} V_{j} \\\\\n\t\\nabla b_{i} & = \\dfrac{\\partial \\mathcal{L}}{\\partial b_{i}} + \\dfrac{\\partial \\mathcal{R}}{\\partial b_{i}} \\\\ & = - \\sigma(-\\hat{r}_{u \\mathcal{P} \\mathcal{A}}) / |\\mathcal{P}| + \\beta_V b_{i}\\\\ \n\t\\nabla b_{j} & = \\dfrac{\\partial \\mathcal{L}}{\\partial b_{j}} + \\dfrac{\\partial \\mathcal{R}}{\\partial b_{j}} \\\\ & = \\sigma(-\\hat{r}_{u \\mathcal{P} \\mathcal{A}}) / |\\mathcal{A}| + \\beta_{V} b_{j}\n\\end{aligned} $$\nAnd the updating rules for each variable are\n\n$$ \\begin{aligned}\nU_{u}^{t+1} & = U_{u}^{t} - \\gamma \\nabla U_{u}^{t}, u \\in \\mathcal{U}^{tr} \\\\\nV_{i}^{t+1} & = V_{i}^{t} - \\gamma \\nabla V_{i}^{t}, i \\in \\mathcal{P} \\\\\nV_{j}^{t+1} & = V_{j}^{t} - \\gamma \\nabla V_{j}^{t}, j \\in \\mathcal{A} \\\\\nb_{i}^{t+1} & = b_{i}^{t} - \\gamma \\nabla b_{i}^{t}, i \\in \\mathcal{P} \\\\ \nb_{j}^{t+1} & = b_{j}^{t} - \\gamma \\nabla b_{j}^{t}, j \\in \\mathcal{A}\n\\end{aligned} $$\n\n\n\n<h2 id=\"JAVA-Implementation\"><a href=\"#JAVA-Implementation\" class=\"headerlink\" title=\"JAVA Implementation\"></a>JAVA Implementation</h2><p>You may find the implementation of COFISET in this famous JAVA library of recommendation systems <a href=\"https://github.com/guoguibing/librec/search?q=COFISET&unscoped_q=COFISET\">LibRec</a>.</p>\n<h1 id=\"BPRH\"><a href=\"#BPRH\" class=\"headerlink\" title=\"BPRH\"></a>BPRH</h1><hr>\n<h2 id=\"Extended-Pairwise-Preferences\"><a href=\"#Extended-Pairwise-Preferences\" class=\"headerlink\" title=\"Extended Pairwise Preferences\"></a>Extended Pairwise Preferences</h2>\n\nFollowing COFISET, BPRH extends the pairwise preferences over item-sets. Besides the target action (e.g. purchase), a type of user's action called auxiliary action is introduced. Viewing, liking, and disliking are examples for auxiliary actions. Now the assumption of pairwise preferences in BPRH becomes $\\hat{r}_{u \\mathcal{I}} > \\hat{r}_{u \\mathcal{J}} > \\hat{r}_{u \\mathcal{K}}, \\mathcal{I} \\subseteq \\mathcal{I}_{t}^{u}, \\mathcal{J} \\subseteq \\mathcal{I}_{t}^{oa}, \\mathcal{K} \\subseteq \\mathcal{I}_{n}^{u}$. $\\mathcal{I} \\subseteq \\mathcal{I}_{t}^{u}$ is a set of items with target feedback from user $u$. $\\mathcal{J} \\subseteq \\mathcal{I}_{t}^{oa}$ is a set of items with only auxiliary feedback from user $u$. And $\\mathcal{K} \\subseteq \\mathcal{I}_{n}^{u}$ is a set of items without any observed feedback from user $u$. Then we can get $\\hat{r}_{u\\mathcal{I}\\mathcal{J}} > 0, \\hat{r}_{u\\mathcal{J}\\mathcal{K}} > 0$ for user $u$.\n\n\n\n<h2 id=\"Objective-Function-and-Optimization-1\"><a href=\"#Objective-Function-and-Optimization-1\" class=\"headerlink\" title=\"Objective Function and Optimization\"></a>Objective Function and Optimization</h2><p>BPRH reaches the maximization for all users $u$ as </p>\n\n\n\t\n\t$$ \\begin{aligned}\n\t\t\\max_{\\Theta} \\quad & f(\\Theta) - \\mathcal{R}(\\Theta)\n\t\\end{aligned}$$\n\t, where $f(\\Theta) = \\sum_{u \\in U} \\left\\lbrace \\sum_{ \\mathcal{I} \\subseteq I^{u}_{t}, \\mathcal{J} \\subseteq I^{u}_{oa} } {\\ln \\sigma \\left( \\dfrac{\\hat{r}_{u \\mathcal{I} \\mathcal{J}} (\\Theta) }{\\alpha_{u}} \\right) } + \\sum_{ \\mathcal{J} \\subseteq I^{u}_{oa}, \\mathcal{K} \\subseteq I^{u}_{n}} {\\ln \\sigma \\left( \\hat{r}_{u \\mathcal{J} \\mathcal{K}} (\\Theta) \\right) } \\right\\rbrace$ is the negative value of loss term, $\\Theta = \\{ U_{u} \\in \\mathbb{R}^{1 \\times d}, V_{i} \\in \\mathbb{R}^{1 \\times d}, b_i \\in \\mathbb{R}, u \\in \\mathcal{U}, i \\in I \\}$ is the set of model parameter, the pairwise preference of user $u$ across 2 item-sets $\\mathcal{I}$ and $\\mathcal{J}$ is $\\hat{r}_{u\\mathcal{I}\\mathcal{J}} = \\hat{r}_{u\\mathcal{I}} - \\hat{r}_{u\\mathcal{J}}$,the pairwise preference of user $u$ across 2 item-sets $\\mathcal{J}$ and $\\mathcal{K}$ is $\\hat{r}_{u\\mathcal{J}\\mathcal{K}} = \\hat{r}_{u\\mathcal{J}} - \\hat{r}_{u\\mathcal{K}}$, the estimated preferences of user $u$ on item-sets $\\mathcal{I}, \\mathcal{J}, \\mathcal{K}$ are $\\hat{r}_{u\\mathcal{I}} = |I|^{-1} \\sum_{i \\in \\mathcal{I}} \\hat{r}_{ui}$, $ \\hat{r}_{u\\mathcal{J}} = |J|^{-1} \\sum_{j \\in \\mathcal{J}} \\hat{r}_{uj}$, $\\hat{r}_{u\\mathcal{K}} = |K|^{-1} \\sum_{k \\in \\mathcal{K}} \\hat{r}_{uk}$, the estimated preference of user $u$ on item $i$ is $\\hat{r}_{ui} = U_{u}^\\top V_{i} + b_i$, and the regularization term $$ \\begin{aligned}\n\t\t\\mathcal{R}(\\Theta) = \\sum_{u \\in U} \\sum_{\\mathcal{I} \\subseteq I^{u}_{t}, \\mathcal{J} \\subseteq I^{u}_{oa}, \\mathcal{K} \\subseteq I^{u}_{n}} \\{ & \\lambda_u \\| U_{u} \\|^2  \\\\ & + \\lambda_v \\left( \\| V_{\\mathcal{I}} \\|^2 + \\| V_{\\mathcal{J}} \\|^2 + \\| V_{\\mathcal{K}} \\|^2 \\right) \\\\ & + \\lambda_b \\left( b_{\\mathcal{I}}^2 + b_{\\mathcal{J}}^2 + b_{\\mathcal{K}}^2 \\right) \\}\n\t\\end{aligned}  $$, $V_{\\mathcal{I}} = |\\mathcal{I}|^{-1} \\sum_{i \\in \\mathcal{I}} V_i$, $V_{\\mathcal{J}} = |\\mathcal{J}|^{-1} \\sum_{j \\in \\mathcal{J}} V_j$, $V_{\\mathcal{K}} = |\\mathcal{K}|^{-1} \\sum_{k \\in \\mathcal{K}} V_k$, $b_{\\mathcal{I}} = |\\mathcal{I}|^{-1} \\sum_{i \\in \\mathcal{I}} b_i$, $b_{\\mathcal{J}} = |\\mathcal{J}|^{-1} \\sum_{j \\in \\mathcal{J}} b_j$, $b_{\\mathcal{K}} = |\\mathcal{K}|^{-1} \\sum_{k \\in \\mathcal{K}} b_k$. $\\alpha_{u}$ is a parameter in $f(\\Theta)$ controlling the contribution of $\\hat{r}_{u \\mathcal{I} \\mathcal{J}} (\\Theta)$ and calculated from data.\n\t\n\n\n<h2 id=\"Corresponding-Gradients-in-SGD-1\"><a href=\"#Corresponding-Gradients-in-SGD-1\" class=\"headerlink\" title=\"Corresponding Gradients in SGD\"></a>Corresponding Gradients in SGD</h2><p>Stochastic gradient descent is utilized in optimization. The corresponding gradients of model parameter $\\Theta$ w.r.t the negative loss term $f(\\Theta)$ and the regularization term $\\mathcal{R}(\\Theta)$ are</p>\n\n\n$$\\begin{aligned}\n\t\t\\dfrac{\\partial f}{\\partial U_{u}} & = \\dfrac{\\partial \\ln(\\sigma)}{\\partial \\sigma} \\dfrac{\\partial \\sigma(\\hat{r}_{u\\mathcal{I}\\mathcal{J}} / \\alpha_{u} )  }{\\partial \\hat{r}_{u\\mathcal{I}\\mathcal{J}} / \\alpha_{u} } \\dfrac{\\partial \\hat{r}_{u\\mathcal{I}\\mathcal{J}} / \\alpha_{u} }{\\partial U_{u}} + \\dfrac{\\partial \\ln(\\sigma)}{\\partial \\sigma} \\dfrac{\\partial \\sigma(\\hat{r}_{u\\mathcal{J}\\mathcal{K}})}{\\partial \\hat{r}_{u\\mathcal{J}\\mathcal{K}} } \\dfrac{\\partial \\hat{r}_{u\\mathcal{J}\\mathcal{K}} }{\\partial U_{u}} \\\\ & = \\alpha_{u}^{-1} \\sigma(- \\alpha_{u}^{-1} \\hat{r}_{u\\mathcal{I}\\mathcal{J}} ) \\left[ |I|^{-1} \\sum_{i \\in \\mathcal{I}} V_{i} - |J|^{-1} \\sum_{j \\in \\mathcal{J}} V_{j} \\right] \\\\ & + \\sigma(- \\hat{r}_{u\\mathcal{J}\\mathcal{K}} ) \\left[ |J|^{-1} \\sum_{j \\in \\mathcal{J}} V_{j} - |K|^{-1} \\sum_{k \\in \\mathcal{K}} V_{k} \\right] \\\\ & = \\alpha_{u}^{-1} \\sigma(- \\alpha_{u}^{-1} \\hat{r}_{u\\mathcal{I}\\mathcal{J}} ) \\left[ \\overline{V}_{\\mathcal{I}} - \\overline{V}_{\\mathcal{J}} \\right] + \\sigma(- \\hat{r}_{u\\mathcal{J}\\mathcal{K}} ) \\left[ \\overline{V}_{\\mathcal{J}} - \\overline{V}_{\\mathcal{K}} \\right], \\forall u \\in U \\\\\n\t\t\\dfrac{\\partial \\mathcal{R}}{\\partial U_{u}} & = 2 \\lambda_{u} U_{u}, \\forall u \\in U\\\\\n\\end{aligned}$$\n\n$$\\begin{aligned}\n\t\t\\dfrac{\\partial f}{\\partial V_{i}} & = \\dfrac{\\partial \\ln(\\sigma)}{\\partial \\sigma} \\dfrac{\\partial \\sigma(\\hat{r}_{u\\mathcal{I}\\mathcal{J}} / \\alpha_{u} )  }{\\partial \\hat{r}_{u\\mathcal{I}\\mathcal{J}} / \\alpha_{u} } \\dfrac{\\partial \\hat{r}_{u\\mathcal{I}\\mathcal{J}} / \\alpha_{u} }{\\partial V_{i}} \\\\ & = (|\\mathcal{I}| \\alpha_{u})^{-1} \\sigma(- \\alpha_u^{-1} \\hat{r}_{u\\mathcal{I}\\mathcal{J}} ) U_{u}, \\forall i \\in \\mathcal{I}\\\\\n\t\t\\dfrac{\\partial \\mathcal{R}}{\\partial V_{i}} & = \\lambda_{v} \\dfrac{\\partial \\| V_{\\mathcal{I}} \\|^2 }{\\partial V_{\\mathcal{I}}} \\dfrac{\\partial V_{\\mathcal{I}}}{\\partial V_{i}} = 2 |\\mathcal{I}|^{-1} \\lambda_{v} V_{\\mathcal{I}}, \\forall i \\in \\mathcal{I} \\\\\n\t\t\\dfrac{\\partial f}{\\partial b_{i}} & = \\dfrac{\\partial \\ln(\\sigma)}{\\partial \\sigma} \\dfrac{\\partial \\sigma(\\hat{r}_{u\\mathcal{I}\\mathcal{J}} / \\alpha_{u} )  }{\\partial \\hat{r}_{u\\mathcal{I}\\mathcal{J}} / \\alpha_{u} } \\dfrac{\\partial \\hat{r}_{u\\mathcal{I}\\mathcal{J}} / \\alpha_{u} }{\\partial b_{i}} \\\\ & = (|\\mathcal{I}| \\alpha_{u})^{-1} \\sigma(- \\alpha_u^{-1} \\hat{r}_{u\\mathcal{I}\\mathcal{J}} ), \\forall i \\in \\mathcal{I}\\\\\n\t\t\\dfrac{\\partial \\mathcal{R}}{\\partial b_{i}} & = \\lambda_b \\dfrac{\\partial b_{\\mathcal{I}}^2 }{\\partial b_{\\mathcal{I}}} \\dfrac{\\partial b_{\\mathcal{I}}}{\\partial b_{i}} = 2 \\lambda_b |\\mathcal{I}|^{-1} b_{\\mathcal{I}}, \\forall i \\in \\mathcal{I} \\\\ \n\\end{aligned}$$\n$$\\begin{aligned}\n\t\t\\dfrac{\\partial f}{\\partial V_{j}} & = \\dfrac{\\partial \\ln(\\sigma)}{\\partial \\sigma} \\dfrac{\\partial \\sigma(\\hat{r}_{u\\mathcal{I}\\mathcal{J}} / \\alpha_{u} )  }{\\partial \\hat{r}_{u\\mathcal{I}\\mathcal{J}} / \\alpha_{u} } \\dfrac{\\partial \\hat{r}_{u\\mathcal{I}\\mathcal{J}} / \\alpha_{u} }{\\partial V_{j} } + \\dfrac{\\partial \\ln(\\sigma)}{\\partial \\sigma} \\dfrac{\\partial \\sigma(\\hat{r}_{u\\mathcal{J}\\mathcal{K}})}{\\partial \\hat{r}_{u\\mathcal{J}\\mathcal{K}} } \\dfrac{\\partial \\hat{r}_{u\\mathcal{J}\\mathcal{K}} }{\\partial V_{j}} \\\\ & = - ( |\\mathcal{J}| \\alpha_{u})^{-1} \\sigma(- \\alpha_{u}^{-1} \\hat{r}_{u\\mathcal{I}\\mathcal{J}} ) U_{u} + |\\mathcal{J}|^{-1} \\sigma(- \\hat{r}_{u\\mathcal{J}\\mathcal{K}} ) U_{u} \\\\ & = |\\mathcal{J}|^{-1} \\left[ - \\alpha_{u}^{-1} \\sigma(- \\alpha_{u}^{-1} \\hat{r}_{u\\mathcal{I}\\mathcal{J}} ) + \\sigma(- \\hat{r}_{u\\mathcal{J}\\mathcal{K}} ) \\right] U_{u}, \\forall j \\in \\mathcal{J} \\\\\n\t\t\\dfrac{\\partial \\mathcal{R}}{\\partial V_{j}} & = \\lambda_{v} \\dfrac{\\partial \\| V_{\\mathcal{J}} \\|^2 }{\\partial V_{\\mathcal{J}}} \\dfrac{\\partial V_{\\mathcal{J}}}{\\partial V_{j}} = 2 |\\mathcal{J}|^{-1} \\lambda_{v} V_{\\mathcal{J}}, \\forall j \\in \\mathcal{J}  \\\\\n\t\t\\dfrac{\\partial f}{\\partial b_{j}} & = \\dfrac{\\partial \\ln(\\sigma)}{\\partial \\sigma} \\dfrac{\\partial \\sigma(\\hat{r}_{u\\mathcal{I}\\mathcal{J}} / \\alpha_{u} )  }{\\partial \\hat{r}_{u\\mathcal{I}\\mathcal{J}} / \\alpha_{u} } \\dfrac{\\partial \\hat{r}_{u\\mathcal{I}\\mathcal{J}} / \\alpha_{u} }{\\partial b_{j} } + \\dfrac{\\partial \\ln(\\sigma)}{\\partial \\sigma} \\dfrac{\\partial \\sigma(\\hat{r}_{u\\mathcal{J}\\mathcal{K}})}{\\partial \\hat{r}_{u\\mathcal{J}\\mathcal{K}} } \\dfrac{\\partial \\hat{r}_{u\\mathcal{J}\\mathcal{K}} }{\\partial b_{j}} \\\\ & = - ( |\\mathcal{J}| \\alpha_{u})^{-1} \\sigma(- \\alpha_{u}^{-1} \\hat{r}_{u\\mathcal{I}\\mathcal{J}} ) + |\\mathcal{J}|^{-1} \\sigma(- \\hat{r}_{u\\mathcal{J}\\mathcal{K}} ) \\\\ & = |\\mathcal{J}|^{-1} \\left[ - \\alpha_{u}^{-1} \\sigma(- \\alpha_{u}^{-1} \\hat{r}_{u\\mathcal{I}\\mathcal{J}} ) + \\sigma(- \\hat{r}_{u\\mathcal{J}\\mathcal{K}} ) \\right], \\forall j \\in \\mathcal{J} \\\\\n\t\t\\dfrac{\\partial \\mathcal{R}}{\\partial b_{j}} & = \\lambda_b \\dfrac{\\partial b_{\\mathcal{J}}^2 }{\\partial b_{\\mathcal{J}}} \\dfrac{\\partial b_{\\mathcal{J}}}{\\partial b_{j}} = 2 \\lambda_b |\\mathcal{J}|^{-1} b_{\\mathcal{J}}, \\forall j \\in \\mathcal{J} \\\\\n\\end{aligned}$$\n$$\\begin{aligned}\n\t\t\\dfrac{\\partial f}{\\partial V_{k}} & = \\dfrac{\\partial \\ln(\\sigma)}{\\partial \\sigma} \\dfrac{\\partial \\sigma(\\hat{r}_{u\\mathcal{J}\\mathcal{K}})  }{\\partial \\hat{r}_{u\\mathcal{J}\\mathcal{K}}} \\dfrac{\\partial \\hat{r}_{u\\mathcal{J}\\mathcal{K}} }{\\partial V_{k}} \\\\ & = - |\\mathcal{K}|^{-1} \\sigma(- \\hat{r}_{u\\mathcal{J}\\mathcal{K}} ) U_{u}, \\forall k \\in \\mathcal{K}\\\\\n\t\t\\dfrac{\\partial \\mathcal{R}}{\\partial V_{k}} & = \\lambda_{v} \\dfrac{\\partial \\| V_{\\mathcal{K}} \\|^2 }{\\partial V_{\\mathcal{K}}} \\dfrac{\\partial V_{\\mathcal{K}}}{\\partial V_{k}} = 2 |\\mathcal{K}|^{-1} \\lambda_{v} V_{\\mathcal{K}}, \\forall k \\in \\mathcal{K}\\\\\n\t\t\\dfrac{\\partial f}{\\partial b_{k}} & = \\dfrac{\\partial \\ln(\\sigma)}{\\partial \\sigma} \\dfrac{\\partial \\sigma(\\hat{r}_{u\\mathcal{J}\\mathcal{K}} )  }{\\partial \\hat{r}_{u\\mathcal{J}\\mathcal{K}}  } \\dfrac{\\partial \\hat{r}_{u\\mathcal{J}\\mathcal{K}}  }{\\partial b_{k}} \\\\ & = - |\\mathcal{K}|^{-1} \\sigma(- \\hat{r}_{u\\mathcal{J}\\mathcal{K}} ), \\forall k \\in \\mathcal{K}\\\\\n\t\t\\dfrac{\\partial \\mathcal{R}}{\\partial b_{k}} & = \\lambda_b \\dfrac{\\partial b_{\\mathcal{K}}^2 }{\\partial b_{\\mathcal{K}}} \\dfrac{\\partial b_{\\mathcal{K}}}{\\partial b_{k}} = 2 \\lambda_b |\\mathcal{K}|^{-1} b_{\\mathcal{K}}, \\forall k \\in \\mathcal{K}\\\\\n\\end{aligned}$$\n\n\n\n<h3 id=\"Updating-Rules-1\"><a href=\"#Updating-Rules-1\" class=\"headerlink\" title=\"Updating Rules\"></a>Updating Rules</h3><p>Combining the gradients w.r.t. the negative loss term and the regularization term, the final gradients for each variable $U_{u}, V_{i}, V_{j}, V_{k}, b_{i}, b_{j}, b_{k}, u \\in U, i \\in \\mathcal{I}, j \\in \\mathcal{J}, k \\in \\mathcal{K}$ are</p>\n\n\n$$ \\begin{aligned}\n\t\\nabla U_{u} & = \\dfrac{\\partial f}{\\partial U_{u}} - \\dfrac{\\partial \\mathcal{R}}{\\partial U_{u}} \\\\ & = \\alpha_{u}^{-1} \\sigma(- \\alpha_{u}^{-1} \\hat{r}_{u\\mathcal{I}\\mathcal{J}} ) \\left[ \\overline{V}_{\\mathcal{I}} - \\overline{V}_{\\mathcal{J}} \\right] + \\sigma(- \\hat{r}_{u\\mathcal{J}\\mathcal{K}} ) \\left[ \\overline{V}_{\\mathcal{J}} - \\overline{V}_{\\mathcal{K}} \\right] - 2 \\lambda_{u} U_{u}, \\forall u \\in U \\\\\n\t\\nabla V_{i} & = \\dfrac{\\partial f}{\\partial V_{i}} - \\dfrac{\\partial \\mathcal{R}}{\\partial V_{i}} \\\\ & = (|\\mathcal{I}| \\alpha_{u})^{-1} \\sigma(- \\alpha_u^{-1} \\hat{r}_{u\\mathcal{I}\\mathcal{J}} ) U_{u} - 2 |\\mathcal{I}|^{-1} \\lambda_{v} V_{\\mathcal{I}}, \\forall i \\in \\mathcal{I}\\\\\n\t\\nabla V_{j} & = \\dfrac{\\partial f}{\\partial V_{j}} - \\dfrac{\\partial \\mathcal{R}}{\\partial V_{j}} \\\\ & = |\\mathcal{J}|^{-1} \\left[ - \\alpha_{u}^{-1} \\sigma(- \\alpha_{u}^{-1} \\hat{r}_{u\\mathcal{I}\\mathcal{J}} ) + \\sigma(- \\hat{r}_{u\\mathcal{J}\\mathcal{K}} ) \\right] U_{u} - 2 |\\mathcal{J}|^{-1} \\lambda_{v} V_{\\mathcal{J}}, \\forall j \\in \\mathcal{J}\\\\\n\t\\nabla V_{k} & = \\dfrac{\\partial f}{\\partial V_{k}} - \\dfrac{\\partial \\mathcal{R}}{\\partial V_{k}} \\\\ & = - |\\mathcal{K}|^{-1} \\sigma(- \\hat{r}_{u\\mathcal{J}\\mathcal{K}} ) U_{u} - 2 |\\mathcal{K}|^{-1} \\lambda_{v} V_{\\mathcal{K}}, \\forall k \\in \\mathcal{K}\\\\\n\t\\nabla b_{i} & = \\dfrac{\\partial f}{\\partial b_{i}} - \\dfrac{\\partial \\mathcal{R}}{\\partial b_{i}} \\\\ & = (|\\mathcal{I}| \\alpha_{u})^{-1} \\sigma(- \\alpha_u^{-1} \\hat{r}_{u\\mathcal{I}\\mathcal{J}} ) - 2 \\lambda_b |\\mathcal{I}|^{-1} b_{\\mathcal{I}}, \\forall i \\in \\mathcal{I}\\\\ \n\t\\nabla b_{j} & = \\dfrac{\\partial f}{\\partial b_{j}} - \\dfrac{\\partial \\mathcal{R}}{\\partial b_{j}} \\\\ & = |\\mathcal{J}|^{-1} \\left[ - \\alpha_{u}^{-1} \\sigma(- \\alpha_{u}^{-1} \\hat{r}_{u\\mathcal{I}\\mathcal{J}} ) + \\sigma(- \\hat{r}_{u\\mathcal{J}\\mathcal{K}} ) \\right] - 2 \\lambda_b |\\mathcal{J}|^{-1} b_{\\mathcal{J}}, \\forall j \\in \\mathcal{J}\\\\\n\t\\nabla b_{k} & = \\dfrac{\\partial f}{\\partial b_{k}} - \\dfrac{\\partial \\mathcal{R}}{\\partial b_{k}} \\\\ & = - |\\mathcal{K}|^{-1} \\sigma(- \\hat{r}_{u\\mathcal{J}\\mathcal{K}} ) - 2 \\lambda_b |\\mathcal{K}|^{-1} b_{\\mathcal{K}}, \\forall k \\in \\mathcal{K}\\\\\n\t\\end{aligned} $$\n\t\n\tAnd the updating rules for each variable are\n\t\n\t$$ \\begin{aligned}\n\tU_{u}^{t+1} & = U_{u}^{t} + \\gamma \\nabla U_{u}^{t}, u \\in U \\\\\n\tV_{i}^{t+1} & = V_{i}^{t} + \\gamma \\nabla V_{i}^{t}, i \\in \\mathcal{I} \\\\\n\tV_{j}^{t+1} & = V_{j}^{t} + \\gamma \\nabla V_{j}^{t}, j \\in \\mathcal{J} \\\\\n\tV_{k}^{t+1} & = V_{k}^{t} + \\gamma \\nabla V_{k}^{t}, k \\in \\mathcal{K} \\\\\n\tb_{i}^{t+1} & = b_{i}^{t} + \\gamma \\nabla b_{i}^{t}, i \\in \\mathcal{I} \\\\ \n\tb_{j}^{t+1} & = b_{j}^{t} + \\gamma \\nabla b_{j}^{t}, j \\in \\mathcal{J} \\\\\n\tb_{k}^{t+1} & = b_{k}^{t} + \\gamma \\nabla b_{k}^{t}, k \\in \\mathcal{K}\n\t\\end{aligned} $$\n\n\n\n<h2 id=\"Online-Updating-for-New-User\"><a href=\"#Online-Updating-for-New-User\" class=\"headerlink\" title=\"Online Updating for New User\"></a>Online Updating for New User</h2><p>Rendle et al (2008) came with an online updating schema in their regularized kernal matrix factorization model along with stochastic gradient descent. Since BPRH also utilizes SGD in its objective function maximization, we can follow Rendle’s methods to update user and item matrices when a new user or item enters the landscape (cold-start problem). You can see the implementation code at <a href=\"https://github.com/liu-yihong/BPRH/blob/master/bprH_gpu.py#L656\">bprH_gpu.py - Line 656</a>.</p>\n\n\n<h2 id=\"Python-Implementation\"><a href=\"#Python-Implementation\" class=\"headerlink\" title=\"Python Implementation\"></a>Python Implementation</h2><p>You can star my BPRH repository and see the details of my BPRH implementation at </p>\n<p><a href=\"https://github.com/liu-yihong/BPRH\"><img src=\"https://github-readme-stats.vercel.app/api/pin/?username=liu-yihong&repo=BPRH&show_owner=true\" alt=\"BPRH Python Implementation\"></a></p>\n<h1 id=\"Reference\"><a href=\"#Reference\" class=\"headerlink\" title=\"Reference\"></a>Reference</h1><ol>\n<li>Rendle, Steffen, et al. “BPR: Bayesian personalized ranking from implicit feedback.” arXiv preprint arXiv:1205.2618 (2012). <a href=\"https://arxiv.org/abs/1205.2618\">link</a></li>\n<li>Pan, Weike, and Li Chen. “Cofiset: Collaborative filtering via learning pairwise preferences over item-sets.” Proceedings of the 2013 SIAM international conference on data mining. Society for Industrial and Applied Mathematics, 2013. <a href=\"https://epubs.siam.org/doi/abs/10.1137/1.9781611972832.20\">link</a></li>\n<li>Qiu, Huihuai, et al. “BPRH: Bayesian personalized ranking for heterogeneous implicit feedback.” Information Sciences 453 (2018): 80-98. <a href=\"https://www.sciencedirect.com/science/article/pii/S0020025516315742\">link</a></li>\n<li>Rendle, Steffen, and Lars Schmidt-Thieme. “Online-updating regularized kernel matrix factorization models for large-scale recommender systems.” Proceedings of the 2008 ACM conference on Recommender systems. 2008. <a href=\"https://dl.acm.org/doi/abs/10.1145/1454008.1454047\">link</a></li>\n</ol>\n",
            "tags": [
                "Ph.D.",
                "Research",
                "Personalized Ranking",
                "Implicit Feedback"
            ]
        }
    ]
}